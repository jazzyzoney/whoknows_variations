# Generating a CR_PAT (Container Registry Personal Access Token)

You can read more about personal access tokens on Github here:

https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens

To deploy to Github Packages (Github's own container registry) via. Github Actions, you need a personal access token.

It is a convention to call the token for accessing Github Packages CR_PAT (Container Registry Personal Access Token). I will do that from now on in this tutorial.

Github has two types of tokens:

1. Fine-grained tokens 

2. Classic access tokens

It is usually prefered to use Fine-grained tokens but the problem as I see it is that Fine-grained tokens do not offer a setting for read and write permission to "Packages". Our goal is to use the token to publish packages, so Fine-grained tokens can't work for this purpose as of now.


# How to generate a CR_PAT (Container Registry Personal Access Token)

We are going to create a **Classic access token**: https://github.com/settings/tokens

This access token will be created on your personal account. It is used to authenticate (logging in) to the container registry. For organisations you must allow the organisation to accept PATs.

## Step 1: Create a policy for your organisation to accept PATs

https://docs.github.com/en/organizations/managing-programmatic-access-to-your-organization/setting-a-personal-access-token-policy-for-your-organization

https://www.youtube.com/watch?v=T-eqWEUdjeM

## Step 2: Generate a PAT

As the name implies (Personal Access) this should be done on your personal account.

https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token

Before clicking **Generate token** choose the **Resource owner** as the organisation you want to give access to.

For better security, you can also choose specific repositories that it has access to. 

Set Repository Permissions
You will need to set the following Repository and Organization permissions:
	•	Contents: Read and Write
	•	Metadata: Read-only
	•	Actions: Read and Write
	•	Deployments: Read and Write (necessary for some deployment actions)
	•	Environments: Read and Write (necessary for managing environments and secrets)
	•	Administration: Read and Write (if needed for managing repository settings)

Copy the token. 

(The user must have admin access to the repository. This is not automatic even if the user has created the organisation. It can be setup in the repository settings -> Collaborators and teams -> Manage access and click **Add people**.)

## Step 3 (Optional): Verify that the token is on the repository. 

1. Go to the repository settings page.

2. On the left choose **Personal access tokens** and **Active tokens** under it. The token should now appear in the list. 

Under **Organization permissions** it should have green check marks for the following:

✅ Read and Write access to organization administration 

And under **Repository permissions** it should have green check marks for the following:

✅ Read access to metadata
✅ Read and Write access to actions and code 


