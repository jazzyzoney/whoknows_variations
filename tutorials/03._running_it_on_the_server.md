# Prerequisite: Make sure that Docker is installed

This is if you are on Ubuntu and haven't installed Docker already.

Make sure that your have updated and upgraded `apt`:

```bash
$ sudo apt update
$ sudo apt upgrade -y
```

Then run the following:

```bash
$ sudo apt install docker.io -y
$ sudo systemctl restart docker
$ sudo apt install -y docker-compose
```

You should also have made sure that the A record is pointing to your server:

```bash
$ dig A <yourdomain.com> +short
```

---

# Install Certbot

Certbot is a tool that will help you get a certificate from Let's Encrypt.

```bash
$ sudo apt install -y certbot
```

---

# Get the certificates

Run the following command:

```bash
$ sudo certbot certonly --standalone -d <yourdomain.com> -d <www.yourdomain.com>
```

---

# Running Nginx over HTTPS

In the `tls` directory, you will find two files:

1. `docker-compose.yml`
2. `nginx.conf`

You can try them out to begin with to get the setup running and later on adjust to fit your needs.

---

# docker-compose.yml

The [docker-compose.yml](../tls/docker-compose.yml) file sets up Nginx with the DockerHub Nginx image and loads the certificates into the container volume.

It exposes port `80` and `443` to the host machine.

**Remember to change all instances of keacloud.dk to your domain.** in this file. 

---

# nginx.conf

The [nginx.conf](../tls/nginx.conf) file is the configuration file for Nginx.

**Remember to change all instances of keacloud.dk to your domain.** in this file. 

---

# Running the setup

Add the two files to the server. You could make a directory for them.

To run the setup, you can run the following command (from the directory where the files are):

```bash
$ sudo docker-compose up -d 
```

Now test it out by going to your domain in a browser.

You should've suceeded.