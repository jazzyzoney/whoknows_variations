# Running Terraform locally

---

## Prerequisites to run Terraform locally

Install [Terraform](https://developer.hashicorp.com/terraform/install?product_intent=terraform) and [Azure CLI](https://developer.hashicorp.com/terraform/tutorials/azure-get-started/azure-build) on your local machine.

The assumption is that you have an SSH key-pair in your `~/.ssh` directory named `id_rsa` and `id_rsa.pub`. If you have a different name, you can change it in the `variables.tf` file.

---

## Defining variables


`variables.tf` contains all variables that are used in the Terraform files. For many of them, the variables are harcoded with a default value. 

Currently, if you were to run `terraform plan` and `terraform apply`, you would be prompted to enter the values not hardcoded in `variables.tf`.

Instead, you could create a file named `terraform.tfvars` and define the values there. This file is automatically loaded by Terraform and its values are used as default values for the variables. In a `.gitignore` template for Terraform it will be ignored.

Aditionally, even if you have defined a default value for a variable, you can overwrite it in the `terraform.tfstate` file.

A sample has been provided. It is named `terraform.tfvars_copy`. Copy it and name the file `terraform.tfvars`. Make changes as needed and you are ready to proceed.

**Note**: Be careful not to push snesitive information. In a standard `.gitignore` template for Terraform it will be ignored because it might contain sensitive information about your infrastructure.

---

## Provisioning with Terraform

To run Terraform, you need to initialize the working directory. This is done by running:

```bash
$ terraform init
```

[Optional] Run `plan` to see what changes will be made:

```bash
$ terraform plan
```

Finally, apply the changes:

```bash
$ terraform apply
```

You will get a chance to see the changes again and confirm them by typing `yes`.

After a successful run, you should see the public IP address and the ssh command in the terminal. Try to log into the VM using the provided command.

---

## Destroying the resources

At some point you might want to take down the infrastructure. 

You can destroy the resources by running:

```bash
$ terraform destroy
```

